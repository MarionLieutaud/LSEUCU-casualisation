xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category") +
geom_text(
data = tab3,
aes(y=total_change,
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
#scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, y, (y-3)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
#scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -3)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
#scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -10)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
#scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -15)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
lolliplot2 <- ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
#scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -15)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
lolliplot2 <- ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
#scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -15)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 6.5, height = 4) # save plot
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 5, height = 6) # save plot
lolliplot2 <- ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(limits = c(-80, 40)) +
personal_theme_simple +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -15)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
lolliplot2
lolliplot2 <- ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(limits = c(-80, 50)) +
personal_theme_simple +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -15)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
lolliplot2
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 5, height = 4) # save plot
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", 6.5, height = 4) # save plot
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 6.5, height = 4) # save plot
O
lolliplot2 <- ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(limits = c(-80, 50)) +
personal_theme_simple +
xlab("") +
labs(title = "Overall change (absolute terms) in permanent academic staff numbers by staff category between 2016-2017 and 2021-2022") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -15)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 6.5, height = 4.5) # save plot
lolliplot2 <- ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(limits = c(-80, 50)) +
personal_theme_simple +
xlab("") +
labs(title = "Overall change (absolute terms) in permanent academic staff numbers\nby staff category between 2016-2017 and 2021-2022",
caption = "LSE HR internal data (2023)") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -15)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 6.5, height = 4.5) # save plot
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 7, height = 4.5) # save plot
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 6, height = 5) # save plot
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 6.5, height = 5) # save plot
lolliplot2 <- ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red")) +
scale_y_continuous(limits = c(-80, 50)) +
personal_theme_simple +
theme(legend.position = "none")+
xlab("") +
labs(title = "Overall change (absolute terms) in permanent academic staff numbers\nby staff category between 2016-2017 and 2021-2022",
caption = "LSE HR internal data (2023)") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -15)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
lolliplot2
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 5, height = 5) # save plot
tab <- hr %>%
filter(!staff_category == "Non-academic positions", academic_employment == "Academic (permanent)") %>%
group_by(academic_year, Staff.Type) %>%
summarise(sum = sum(Headcount.Rounded))
tab2 <- data.frame(academic_year = c("2016-2017", "2017-2018"),
Staff.Type = c("Guest Teacher", "Guest Teacher"),
sum = c(0, 0)) # add rows with zero permanent positions for guest teachers prior to 2018-2019
# we assume it is zero since no guest teachers appear among permanent academic staff prior to 2018-2018
tab <- bind_rows(tab2, tab)
#lagged values to calculate change
tab <- tab %>%
group_by(Staff.Type) %>%
filter(!Staff.Type == "Policy") %>% # remove this empty category
mutate(sum_previous_year = lag(sum, n=1),
absolute_change = sum - sum_previous_year,
total_change = (sum[academic_year == "2021-2022"]) - (sum[academic_year == "2016-2017"]),
categorical_change = case_when(
total_change > 0 ~ "increase",
total_change == 0 ~ "no change",
total_change < 0 ~ "decrease"),
categorical_change = factor(categorical_change, levels = c("increase", "decrease", "no change")),
staff_type = recode(Staff.Type,
"Guest Teacher" = "Guest teachers\n(permanent only)",
"Research" = "Research-only",
"Teaching" = "Teaching-only\n(Education-track)",
"Teaching and Research" = "Teaching and research"),
staff_type = factor(staff_type, levels = c("Guest teachers\n(permanent only)",
"Research-only",
"Teaching-only\n(Education-track)",
"Teaching and research")))
#lollipop plot 1: year-by-year
lolliplot1 <- ggplot(tab, aes(x=academic_year, y=total_change, colour = categorical_change, group = staff_type)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=academic_year, xend=academic_year, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
facet_wrap(~ staff_type) +
scale_color_manual(values = c("black", "red", "grey"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple_facets +
theme(legend.position = "none") +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category (LSE HR internal data)")
ggsave(lolliplot1, filename = "plot_LSEHR_changepermanentstaff.png", width = 6.5, height = 4) # save plot
ggsave(lolliplot1, filename = "plot_LSEHR_changepermanentstaff.png", width = 8, height = 10) # save plot
#lollipop plot 1: year-by-year
lolliplot1 <- ggplot(tab, aes(x=academic_year, y=total_change, colour = categorical_change, group = staff_type)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=academic_year, xend=academic_year, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
facet_wrap(~ staff_type) +
scale_color_manual(values = c("black", "red", "grey"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple_facets +
theme(legend.position = "none") +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category (LSE HR internal data)")
lolliplot1
tab <- tab %>%
group_by(Staff.Type) %>%
filter(!Staff.Type == "Policy") %>% # remove this empty category
mutate(sum_previous_year = lag(sum, n=1),
absolute_change = sum - sum_previous_year,
total_change = (sum[academic_year == "2021-2022"]) - (sum[academic_year == "2016-2017"]),
categorical_change = case_when(
total_change > 0 ~ "increase",
total_change == 0 ~ "no change",
total_change < 0 ~ "decrease"),
categorical_change = factor(categorical_change, levels = c("increase", "decrease", "no change")),
staff_type = recode(Staff.Type,
"Guest Teacher" = "Guest teachers\n(permanent only)",
"Research" = "Research-only",
"Teaching" = "Teaching-only\n(Education-track)",
"Teaching and Research" = "Teaching and research"),
staff_type = factor(staff_type, levels = c("Guest teachers\n(permanent only)",
"Research-only",
"Teaching-only\n(Education-track)",
"Teaching and research")))
lolliplot1 <- ggplot(tab, aes(x=academic_year, y=total_change, colour = categorical_change, group = staff_type)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=academic_year, xend=academic_year, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
facet_wrap(~ staff_type) +
scale_color_manual(values = c("black", "red", "grey"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple_facets +
theme(legend.position = "none") +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category (LSE HR internal data)")
lolliplot1
tab <- hr %>%
filter(!staff_category == "Non-academic positions", academic_employment == "Academic (permanent)") %>%
group_by(academic_year, Staff.Type) %>%
summarise(sum = sum(Headcount.Rounded))
tab2 <- data.frame(academic_year = c("2016-2017", "2017-2018"),
Staff.Type = c("Guest Teacher", "Guest Teacher"),
sum = c(0, 0)) # add rows with zero permanent positions for guest teachers prior to 2018-2019
# we assume it is zero since no guest teachers appear among permanent academic staff prior to 2018-2018
tab <- bind_rows(tab2, tab)
tab
#lagged values to calculate change
tab <- tab %>%
group_by(Staff.Type) %>%
filter(!Staff.Type == "Policy") %>% # remove this empty category
mutate(sum_previous_year = lag(sum, n=1),
absolute_change = sum - sum_previous_year,
total_change = (sum[academic_year == "2021-2022"]) - (sum[academic_year == "2016-2017"]),
categorical_change = case_when(
total_change > 0 ~ "increase",
total_change == 0 ~ "no change",
total_change < 0 ~ "decrease"),
categorical_change = factor(categorical_change, levels = c("increase", "decrease", "no change")),
staff_type = recode(Staff.Type,
"Guest Teacher" = "Guest teachers\n(permanent only)",
"Research" = "Research-only",
"Teaching" = "Teaching-only\n(Education-track)",
"Teaching and Research" = "Teaching and research"),
staff_type = factor(staff_type, levels = c("Guest teachers\n(permanent only)",
"Research-only",
"Teaching-only\n(Education-track)",
"Teaching and research")))
#lollipop plot 1: year-by-year
lolliplot1 <- ggplot(tab, aes(x=academic_year, y=absolute_change, colour = categorical_change, group = staff_type)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=academic_year, xend=academic_year, y=0, yend=absolute_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
facet_wrap(~ staff_type) +
scale_color_manual(values = c("black", "red", "grey"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple_facets +
theme(legend.position = "none") +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category (LSE HR internal data)")
lolliplot1
#lagged values to calculate change
tab <- tab %>%
group_by(Staff.Type) %>%
filter(!Staff.Type == "Policy") %>% # remove this empty category
mutate(sum_previous_year = lag(sum, n=1),
absolute_change = sum - sum_previous_year,
total_change = (sum[academic_year == "2021-2022"]) - (sum[academic_year == "2016-2017"]),
categorical_change = case_when(
absolute_change > 0 ~ "increase",
absolute_change == 0 ~ "no change",
absolute_change < 0 ~ "decrease"),
categorical_change = factor(categorical_change, levels = c("increase", "decrease", "no change")),
staff_type = recode(Staff.Type,
"Guest Teacher" = "Guest teachers\n(permanent only)",
"Research" = "Research-only",
"Teaching" = "Teaching-only\n(Education-track)",
"Teaching and Research" = "Teaching and research"),
staff_type = factor(staff_type, levels = c("Guest teachers\n(permanent only)",
"Research-only",
"Teaching-only\n(Education-track)",
"Teaching and research")))
#lollipop plot 1: year-by-year
lolliplot1 <- ggplot(tab, aes(x=academic_year, y=absolute_change, colour = categorical_change, group = staff_type)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=academic_year, xend=academic_year, y=0, yend=absolute_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
facet_wrap(~ staff_type) +
scale_color_manual(values = c("black", "red", "grey"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple_facets +
theme(legend.position = "none") +
xlab("") +
labs(title = "Change (absolute terms) in permanent academic staff numbers by staff category (LSE HR internal data)")
lolliplot1
ggsave(lolliplot1, filename = "lolliplot_LSEHR_changepermanentstaff.png", width = 8, height = 10) # save plot
ggsave(lolliplot1, filename = "lolliplot_LSEHR_changepermanentstaff.png", width = 7, height = 8) # save plot
ggsave(lolliplot1, filename = "lolliplot_LSEHR_changepermanentstaff.png", width = 6, height = 7) # save plot
#lollipop plot 1: year-by-year
lolliplot1 <- ggplot(tab, aes(x=academic_year, y=absolute_change, colour = categorical_change, group = staff_type)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=academic_year, xend=academic_year, y=0, yend=absolute_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
facet_wrap(~ staff_type) +
scale_color_manual(values = c("black", "red", "grey"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple_facets +
theme(legend.position = "none") +
xlab("") +
labs(title = "Yearly change (absolute terms) in permanent academic staff numbers by staff category (LSE HR internal data)",
caption = "Source: LSE internal HR data (2023)")
ggsave(lolliplot1, filename = "lolliplot_LSEHR_changepermanentstaff.png", width = 6, height = 7.5) # save plot
#lagged values to calculate change
tab <- tab %>%
group_by(Staff.Type) %>%
filter(!Staff.Type == "Policy") %>% # remove this empty category
mutate(sum_previous_year = lag(sum, n=1),
absolute_change = sum - sum_previous_year,
total_change = (sum[academic_year == "2021-2022"]) - (sum[academic_year == "2016-2017"]),
categorical_change = case_when(
absolute_change > 0 ~ "increase",
absolute_change == 0 ~ "no change",
absolute_change < 0 ~ "decrease"),
categorical_change = factor(categorical_change, levels = c("increase", "decrease", "no change")),
staff_type = recode(Staff.Type,
"Guest Teacher" = "Guest teachers\n(permanent only)",
"Research" = "Research-only",
"Teaching" = "Teaching-only\n(Education-track)",
"Teaching and Research" = "Teaching and research"),
staff_type = factor(staff_type, levels = c("Teaching and research",
"Guest teachers\n(permanent only)",
"Research-only",
"Teaching-only\n(Education-track)")))
#lollipop plot 1: year-by-year
lolliplot1 <- ggplot(tab, aes(x=academic_year, y=absolute_change, colour = categorical_change, group = staff_type)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=academic_year, xend=academic_year, y=0, yend=absolute_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
facet_wrap(~ staff_type) +
scale_color_manual(values = c("black", "red", "grey"), name="Change (absolute numbers)", na.translate = F) +
scale_y_continuous(breaks = seq(-20, 20, by= 10)) +
personal_theme_simple_facets +
theme(legend.position = "none") +
xlab("") +
labs(title = "Yearly change (absolute terms) in permanent academic staff numbers by staff category (LSE HR internal data)",
caption = "Source: LSE internal HR data (2023)")
ggsave(lolliplot1, filename = "lolliplot_LSEHR_changepermanentstaff.png", width = 6, height = 7) # save plot
# lollipop plot 2: change over the period
tab2 <- tab %>% filter(academic_year == "2021-2022")
tab3 <- tab2 %>%
ungroup() %>%
add_row(staff_type = "All combined", total_change = sum(tab2$total_change)) %>%
mutate(categorical_change = case_when(
total_change > 0 ~ "increase",
total_change < 0 ~ "decrease"),
categorical_change = factor(categorical_change, levels = c("increase", "decrease")),
staff_type = factor(staff_type, levels = c("Teaching and research",
"Guest teachers\n(permanent only)",
"Research-only",
"Teaching-only\n(Education-track)",
"All combined")))
lolliplot2 <- ggplot(tab3, aes(x=staff_type, y=total_change, colour = categorical_change)) +
geom_hline(aes(yintercept=0), colour = "black") +
geom_segment(aes(x=staff_type, xend=staff_type, y=0, yend=total_change, color = categorical_change)) +
geom_point(aes(color=categorical_change), size=2) +
scale_color_manual(values = c("black", "red")) +
scale_y_continuous(limits = c(-80, 50)) +
personal_theme_simple +
theme(legend.position = "none")+
xlab("") +
labs(title = "Overall change (absolute terms) in permanent academic staff numbers\nby staff category between 2016-2017 and 2021-2022",
caption = "Source: LSE internal HR data (2023)") +
geom_text(
data = tab3,
aes(y = ifelse(total_change > 0, total_change, (total_change -15)),
x = staff_type,
label = ifelse(total_change > 0, paste0("+", total_change), total_change),
colour = categorical_change),
vjust = -1,
#nudge_y = 2,
family = "Arial Narrow",
fontface = "bold",
size = 4)
ggsave(lolliplot2, filename = "lolliplot_LSEHR_combinedchangepermanent.png", width = 5, height = 5) # save plot
tab <- hr %>%
filter(!staff_category == "Non-academic positions") %>%
group_by(academic_year, academic_employment) %>%
summarise(sum = sum(Headcount.Rounded))
tab
